# 監査チーム管理画面 テストシナリオ

**対応UI仕様**: `docs/ui/07_audit_team.md`
**テストクラス**: `AuditTeamTests`
**最終更新**: 2025-01-01

---

## 進捗サマリ

| 状態 | 件数 |
|------|------|
| ✅ 実装済み | 0 |
| 🔸 スタブ | 0 |
| ⏳ 未実装 | 10 |

---

## 画面概要

監査チームの作成・編集・ロック操作を行う画面。監査チームはプロジェクトと同列のトップレベル概念。

```
┌─────────────────────────────────────────────────────────────────────────────┐
│  🛡️ 監査チーム管理                               [+ 新規]    ⚙️            │
├────────────┬────────────────────────────────────────────────────────────────┤
│            │                                                                │
│ 📁 Projects│  監査チーム一覧                                                │
│ 👥 Agents  │  ┌──────────────────────────────────────────────────────┐     │
│ 🛡️ Audit   │  │ 🛡️ セキュリティ監査チーム              ⚡ Active    │     │
│   > Team A │  │    監査エージェント: 2                               │     │
│ 📜 History │  │    監視対象プロジェクト: Project A, Project B        │     │
│            │  │    アクティブロック: 1                               │     │
│            │  └──────────────────────────────────────────────────────┘     │
└────────────┴────────────────────────────────────────────────────────────────┘
```

---

## テストシナリオ

### TS-07-001: 監査チーム一覧画面構成確認

**目的**: 監査チーム一覧画面に必要な要素が表示されること

**前提条件**:
- アプリが起動している
- サイドバーでAuditセクションが選択されている

**手順**:
1. 監査チーム管理画面を表示する
2. 画面構成を確認する

**期待結果**:
- 「監査チーム管理」タイトルが表示される
- 「+ 新規」ボタンが存在する
- 検索フィールドが存在する
- 監査チームカード一覧が表示される
- フッターにサマリ（チーム数、アクティブ数、ロック数）が表示される

**PRD参照**: 画面概要
```
│  🛡️ 監査チーム管理                               [+ 新規]    ⚙️            │
│  2 teams | 1 active | 1 lock active                                         │
```

**実装状態**: ⏳ 未実装

---

### TS-07-002: 監査チームカード情報表示

**目的**: 監査チームカードに必要な情報が表示されること

**前提条件**:
- 監査チーム管理画面が表示されている
- 少なくとも1つの監査チームが存在する

**手順**:
1. 監査チームカードを確認する

**期待結果**:
- チーム名が表示される
- ステータスバッジが表示される（Active/Archived）
- 監査エージェント数が表示される
- 監視対象プロジェクト名リストが表示される
- アクティブロック数が表示される

**PRD参照**: 監査チームカード
```
┌────────────────────────────────────────────────────────────────┐
│ 🛡️ [チーム名]                                    [ステータス]  │
│    監査エージェント: [数]                                      │
│    監視対象プロジェクト: [プロジェクト名リスト]                │
│    アクティブロック: [数]                                      │
└────────────────────────────────────────────────────────────────┘
```

**実装状態**: ⏳ 未実装

---

### TS-07-003: 新規監査チーム作成シート表示

**目的**: 「+ 新規」ボタンをタップすると新規作成シートが表示されること

**前提条件**:
- 監査チーム管理画面が表示されている

**手順**:
1. 「+ 新規」ボタンをタップする
2. シートの表示を確認する

**期待結果**:
- モーダルシートが表示される
- 以下の入力要素が存在する:
  - チーム名（必須）
  - 説明
  - 監査エージェント割り当て（チェックボックスリスト）
- 「キャンセル」ボタンが存在する
- 「作成」ボタンが存在する

**PRD参照**: 新規監査チーム作成
```
│  チーム名 *                                                    │
│  説明                                                          │
│  監査エージェントを割り当て                                    │
│  │ ☑ 🤖 security-auditor                                   │ │
```

**実装状態**: ⏳ 未実装

---

### TS-07-004: 監査チーム詳細画面構成

**目的**: 監査チームを選択すると詳細画面が表示されること

**前提条件**:
- 監査チーム管理画面が表示されている
- 少なくとも1つの監査チームが存在する

**手順**:
1. 監査チームカードをクリックする
2. 詳細画面の表示を確認する

**期待結果**:
- 詳細パネルが表示される
- 以下のタブが存在する:
  1. 基本情報
  2. エージェント
  3. ロック
  4. 監視対象
- 「編集」ボタンが存在する

**PRD参照**: 監査チーム詳細
```
│  ┌─────────┬─────────┬─────────┬─────────────────────────────┐ │
│  │ 基本情報 │エージェント│ ロック  │ 監視対象                    │ │
```

**実装状態**: ⏳ 未実装

---

### TS-07-005: エージェントタブ表示

**目的**: エージェントタブに監査エージェント一覧が表示されること

**前提条件**:
- 監査チーム詳細画面が表示されている

**手順**:
1. 「エージェント」タブを選択する
2. 一覧を確認する

**期待結果**:
- 監査エージェントカードが表示される
- 各カードに以下が表示される:
  - エージェント名
  - 接続状態（接続中/オフライン）
  - Role: Auditor
  - 権限情報
  - タスクロック数
  - エージェントロック数
- 「+ エージェントを追加」ボタンが存在する

**PRD参照**: エージェントタブ
```
│  │ 🤖 security-auditor                         🟢 接続中    │ │
│  │    Role: Auditor | 権限: 全プロジェクト閲覧 + ロック     │ │
│  │    タスクロック: 1 | エージェントロック: 0               │ │
```

**実装状態**: ⏳ 未実装

---

### TS-07-006: ロックタブ表示

**目的**: ロックタブにアクティブロック一覧が表示されること

**前提条件**:
- 監査チーム詳細画面が表示されている

**手順**:
1. 「ロック」タブを選択する
2. 一覧を確認する

**期待結果**:
- 「タスクロック」セクションが表示される
- 「エージェントロック」セクションが表示される
- 各ロックカードに以下が表示される:
  - ロック対象名
  - プロジェクト名（タスクロックの場合）
  - ロック者
  - ロック日時
  - 理由
  - 「ロック解除」ボタン
- 「+ タスクをロック」ボタンが存在する
- 「+ エージェントをロック」ボタンが存在する

**PRD参照**: ロックタブ
```
│  │ 🔒 API実装                                               │ │
│  │    プロジェクト: ECサイト開発                            │ │
│  │    ロック者: 🤖 security-auditor                         │ │
│  │    ロック日時: 2024-12-30 14:00                          │ │
│  │    理由: セキュリティレビュー待ち                        │ │
│  │                                        [ロック解除]      │ │
```

**実装状態**: ⏳ 未実装

---

### TS-07-007: タスクロック機能

**目的**: タスクをロックできること

**前提条件**:
- 監査チーム詳細画面が表示されている
- ロックタブが選択されている

**手順**:
1. 「+ タスクをロック」ボタンをタップする
2. モーダルの表示を確認する
3. タスクを選択する
4. ロック理由を入力する
5. 「ロック」ボタンをタップする

**期待結果**:
- ロックモーダルが表示される
- 以下の入力要素が存在する:
  - 対象タスク（検索可能なリスト、必須）
  - ロック理由（必須）
- 警告メッセージが表示される
- ロック完了後、ロックタブに追加される

**PRD参照**: タスクロック
```
│  対象タスク *                                                  │
│  ロック理由 *                                                  │
│  ⚠️ ロック中はタスクの状態変更が禁止されます                  │
```

**実装状態**: ⏳ 未実装

---

### TS-07-008: エージェントロック機能

**目的**: エージェントをロックできること

**前提条件**:
- 監査チーム詳細画面が表示されている
- ロックタブが選択されている

**手順**:
1. 「+ エージェントをロック」ボタンをタップする
2. モーダルの表示を確認する
3. エージェントを選択する
4. ロック理由を入力する
5. 「ロック」ボタンをタップする

**期待結果**:
- ロックモーダルが表示される
- 以下の入力要素が存在する:
  - 対象エージェント（検索可能なリスト、必須）
  - ロック理由（必須）
- 警告メッセージが表示される
- ロック完了後、ロックタブに追加される

**PRD参照**: エージェントロック
```
│  対象エージェント *                                            │
│  ロック理由 *                                                  │
│  ⚠️ ロック中はエージェントの全操作が禁止されます              │
```

**実装状態**: ⏳ 未実装

---

### TS-07-009: ロック解除機能

**目的**: ロックを解除できること

**前提条件**:
- アクティブなロックが存在する
- ロックタブが表示されている

**手順**:
1. ロックカードの「ロック解除」ボタンをタップする
2. モーダルの表示を確認する
3. 解除理由を入力する
4. 「解除」ボタンをタップする

**期待結果**:
- ロック解除モーダルが表示される
- ロック情報（ロック者、日時、理由）が表示される
- 解除理由入力フィールドが存在する（必須）
- 警告メッセージ（監査エージェントのみ解除可能）が表示される
- 解除完了後、ロック一覧から削除される

**PRD参照**: ロック解除
```
│  ロック者: 🤖 security-auditor                                 │
│  ロック日時: 2024-12-30 14:00                                  │
│  理由: セキュリティレビュー待ち                                │
│  解除理由 *                                                    │
│  ⚠️ 監査エージェントのみがロックを解除できます                │
```

**実装状態**: ⏳ 未実装

---

### TS-07-010: コンテキストメニュー表示

**目的**: 監査チームを右クリックするとコンテキストメニューが表示されること

**前提条件**:
- 監査チーム管理画面が表示されている
- 少なくとも1つの監査チームが存在する

**手順**:
1. 監査チームカードを右クリックする
2. メニューの表示を確認する

**期待結果**:
- 以下のメニュー項目が表示される:
  - 詳細を開く
  - 編集
  - エージェント管理
  - タスクをロック
  - エージェントをロック
  - アーカイブ
  - 削除

**PRD参照**: コンテキストメニュー
```
┌─────────────────────────┐
│ 📋 詳細を開く           │
│ ✏️ 編集                 │
│ 👥 エージェント管理     │
│ 🔒 タスクをロック       │
│ 🔒 エージェントをロック │
│ 📦 アーカイブ           │
│ 🗑️ 削除                 │
└─────────────────────────┘
```

**実装状態**: ⏳ 未実装

---

## 監査チームステータス仕様

| ステータス | アイコン | 説明 |
|-----------|---------|------|
| Active | ⚡ | 有効な監査チーム |
| Archived | 📦 | アーカイブ済み |

---

## ロックタイプ仕様

| タイプ | 対象 | 効果 |
|--------|------|------|
| task | タスク | タスクの状態変更を禁止 |
| agent | エージェント | エージェントの全操作を禁止 |

---

## 権限仕様

| 操作 | 監査エージェント | 通常エージェント |
|------|-----------------|-----------------|
| ロック作成 | ✅ | ❌ |
| ロック解除 | ✅ | ❌ |
| 全プロジェクト閲覧 | ✅ | ❌ |
| エージェント行動ログ閲覧 | ✅ | ❌ |

---

## 変更履歴

| 日付 | 内容 |
|------|------|
| 2025-01-01 | 初版作成 |
