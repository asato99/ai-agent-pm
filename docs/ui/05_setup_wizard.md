# セットアップウィザード

アプリ初回起動時のセットアップフローを案内する画面。

---

## フロー概要

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│ Welcome │ →  │ Project │ →  │  Owner  │ →  │  Agent  │ →  │ Complete│
│         │    │ Create  │    │ Create  │    │ Create  │    │         │
└─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘
```

---

## Step 1: Welcome

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│                                                                            │
│                                                                            │
│                              🤖                                            │
│                                                                            │
│                      AI Agent PM へようこそ                                │
│                                                                            │
│           AIエージェントと協働するプロジェクト管理を始めましょう           │
│                                                                            │
│                                                                            │
│    ┌────────────────────────────────────────────────────────────────┐     │
│    │                                                                │     │
│    │  ✅ タスク管理 - エージェントがタスクを自律的に管理           │     │
│    │                                                                │     │
│    │  ✅ コンテキスト共有 - セッション間で記憶を継続               │     │
│    │                                                                │     │
│    │  ✅ ハンドオフ - エージェント間でスムーズに引き継ぎ           │     │
│    │                                                                │     │
│    │  ✅ MCP連携 - Claude Codeと直接連携                           │     │
│    │                                                                │     │
│    └────────────────────────────────────────────────────────────────┘     │
│                                                                            │
│                                                                            │
│                           [始める →]                                      │
│                                                                            │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Step 2: プロジェクト作成

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│  セットアップ                                          ステップ 1/4       │
│  ━━━━━━━━━━━━━━━━━━━━●━━━━━━━━━━━━━━━━━━○━━━━━━━━━━━━○━━━━━━━━━━━━○        │
│                                                                            │
│                                                                            │
│                         📁 プロジェクトを作成                              │
│                                                                            │
│           最初のプロジェクトを作成しましょう                               │
│                                                                            │
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                                                                      │ │
│  │  プロジェクト名 *                                                    │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ My First Project                                               │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  説明 (任意)                                                         │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │                                                                │ │ │
│  │  │                                                                │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│                                                                            │
│                                                           [次へ →]        │
│                                                                            │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Step 3: オーナー登録

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│  セットアップ                                          ステップ 2/4       │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━●━━━━━━━━━━━━━━━━━━○━━━━━━━━━━━━○        │
│                                                                            │
│                                                                            │
│                         👤 あなたを登録                                    │
│                                                                            │
│           プロジェクトオーナーとして登録します                             │
│                                                                            │
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                                                                      │ │
│  │  タイプ                                                              │ │
│  │  ┌────────────────┐                                                  │ │
│  │  │     👤         │  ← 人間として登録されます                        │ │
│  │  │    Human       │                                                  │ │
│  │  └────────────────┘                                                  │ │
│  │                                                                      │ │
│  │  名前 *                                                              │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ owner                                                          │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  役割                                                                │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ プロジェクトオーナー                                           │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  権限タイプ                                                          │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ Owner (全権限)                                           🔒   │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│                                                     [← 戻る]  [次へ →]    │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Step 4: AIエージェント作成（オプション）

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│  セットアップ                                          ステップ 3/4       │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━●━━━━━━━━━━━━○           │
│                                                                            │
│                                                                            │
│                         🤖 AIエージェントを作成                            │
│                                                                            │
│           Claude Codeで使用するAIエージェントを作成します                  │
│                 (後からでも作成できます)                                   │
│                                                                            │
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                                                                      │ │
│  │  名前 * (英数字、ハイフン)                                           │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ dev-agent                                                      │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  役割 *                                                              │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ 開発担当                                                       │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  専門分野 (カンマ区切り)                                             │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ Python, TypeScript, React                                      │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  権限タイプ                                                          │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ Worker (推奨)                                              ▼  │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│                                     [スキップ]  [← 戻る]  [次へ →]        │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## Step 5: Claude Code設定

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│  セットアップ                                          ステップ 4/4       │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━●           │
│                                                                            │
│                                                                            │
│                         🔧 Claude Code設定                                 │
│                                                                            │
│           以下の設定をClaude Codeに追加してください                        │
│                                                                            │
│                                                                            │
│  ┌──────────────────────────────────────────────────────────────────────┐ │
│  │                                                                      │ │
│  │  設定ファイルの場所:                                                 │ │
│  │  ~/.claude/claude_desktop_config.json                               │ │
│  │                                                                      │ │
│  │  追加する内容:                                                       │ │
│  │  ┌────────────────────────────────────────────────────────────────┐ │ │
│  │  │ {                                                              │ │ │
│  │  │   "mcpServers": {                                              │ │ │
│  │  │     "agent-pm-dev-agent": {                                    │ │ │
│  │  │       "command": "/Applications/AI Agent PM.app/Conte..."      │ │ │
│  │  │       "args": [                                                │ │ │
│  │  │         "--db", "~/Library/Application Support/...",           │ │ │
│  │  │         "--agent-id", "agt_xyz789"                             │ │ │
│  │  │       ]                                                        │ │ │
│  │  │     }                                                          │ │ │
│  │  │   }                                                            │ │ │
│  │  │ }                                                              │ │ │
│  │  └────────────────────────────────────────────────────────────────┘ │ │
│  │                                                                      │ │
│  │  ┌─────────────────┐  ┌─────────────────┐                           │ │
│  │  │   📋 コピー     │  │   🔧 自動設定   │                           │ │
│  │  └─────────────────┘  └─────────────────┘                           │ │
│  │                                                                      │ │
│  │  ⚠️ 設定後、Claude Codeを再起動してください                         │ │
│  │                                                                      │ │
│  └──────────────────────────────────────────────────────────────────────┘ │
│                                                                            │
│                                                     [← 戻る]  [完了]      │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 完了画面

```
┌────────────────────────────────────────────────────────────────────────────┐
│                                                                            │
│                                                                            │
│                                                                            │
│                                 ✅                                         │
│                                                                            │
│                        セットアップ完了!                                   │
│                                                                            │
│                                                                            │
│    ┌────────────────────────────────────────────────────────────────┐     │
│    │                                                                │     │
│    │  📁 プロジェクト: My First Project                            │     │
│    │                                                                │     │
│    │  👤 オーナー: owner                                           │     │
│    │                                                                │     │
│    │  🤖 エージェント: dev-agent                                   │     │
│    │                                                                │     │
│    └────────────────────────────────────────────────────────────────┘     │
│                                                                            │
│                                                                            │
│    次のステップ:                                                           │
│                                                                            │
│    1. Claude Codeを再起動                                                  │
│    2. Claude Codeで get_my_profile を実行して接続確認                     │
│    3. タスクを作成してAIエージェントにアサイン                             │
│                                                                            │
│                                                                            │
│                        [プロジェクトを開く]                                │
│                                                                            │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 自動設定の確認ダイアログ

```
┌────────────────────────────────────────────────────────────────┐
│  Claude Code設定を自動更新                              [×]   │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  以下のファイルを更新します:                                   │
│                                                                │
│  ~/.claude/claude_desktop_config.json                         │
│                                                                │
│  ┌──────────────────────────────────────────────────────────┐ │
│  │ 変更内容:                                                │ │
│  │ + "agent-pm-dev-agent": { ... }                          │ │
│  └──────────────────────────────────────────────────────────┘ │
│                                                                │
│  ⚠️ 既存の設定はバックアップされます                          │
│     (~/.claude/claude_desktop_config.json.backup)             │
│                                                                │
│                     [キャンセル]  [更新する]                  │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

---

## エラー状態

### 設定ファイルが見つからない

```
┌────────────────────────────────────────────────────────────────┐
│  ⚠️ Claude Code設定が見つかりません                    [×]   │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  ~/.claude/claude_desktop_config.json が見つかりません。      │
│                                                                │
│  Claude Codeがインストールされていることを確認してください。   │
│                                                                │
│  ┌─────────────────┐  ┌─────────────────┐                     │
│  │ 手動で設定する  │  │ 新規作成する    │                     │
│  └─────────────────┘  └─────────────────┘                     │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

---

## 状態管理

```swift
struct SetupWizardState {
    var currentStep: SetupStep
    var projectDraft: ProjectDraft
    var ownerDraft: AgentDraft
    var aiAgentDraft: AgentDraft?
    var skipAIAgent: Bool
    var isProcessing: Bool
    var error: SetupError?
}

enum SetupStep: Int {
    case welcome = 0
    case projectCreate = 1
    case ownerCreate = 2
    case aiAgentCreate = 3
    case claudeCodeConfig = 4
    case complete = 5
}

struct ProjectDraft {
    var name: String
    var description: String
}
```

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2024-12-30 | 1.0.0 | 初版作成 |
