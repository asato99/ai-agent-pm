# プロジェクト一覧画面

プロジェクトの選択・作成・管理を行う画面。

---

## 画面概要

```
┌─────────────────────────────────────────────────────────────────────┐
│  AI Agent PM                                    [+] New    ⚙️       │
├────────────┬────────────────────────────────────────────────────────┤
│            │                                                        │
│ 📁 Projects│  ┌──────────────────────────────────────────────────┐ │
│ ┌────────┐ │  │                                                  │ │
│ │Project │ │  │   📁 My Projects                                 │ │
│ │   A    │ │  │                                                  │ │
│ └────────┘ │  │   ┌────────────────────────────────────────────┐ │ │
│ ┌────────┐ │  │   │ 📁 ECサイト開発                    ⚡ Active │ │ │
│ │Project │ │  │   │    タスク: 12 | 完了: 5 | 進行中: 3         │ │ │
│ │   B    │ │  │   │    エージェント: 4                          │ │ │
│ └────────┘ │  │   │    更新: 2時間前 - タスク更新               │ │ │
│            │  │   └────────────────────────────────────────────┘ │ │
│            │  │                                                  │ │
│ 👥 Agents  │  │   ┌────────────────────────────────────────────┐ │ │
│            │  │   │ 📁 モバイルアプリ                          │ │ │
│ 💬 Sessions│  │   │    タスク: 8 | 完了: 8 | 進行中: 0          │ │ │
│            │  │   │    エージェント: 2                          │ │ │
│            │  │   │    更新: 3日前 - 完了             ✅ Done  │ │ │
│            │  │   └────────────────────────────────────────────┘ │ │
│            │  │                                                  │ │
│            │  │   ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┐ │ │
│            │  │     + 新規プロジェクトを作成                    │ │
│            │  │   └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─┘ │ │
│            │  │                                                  │ │
│            │  └──────────────────────────────────────────────────┘ │
│            │                                                        │
├────────────┴────────────────────────────────────────────────────────┤
│  3 projects | Last sync: Just now                                   │
└─────────────────────────────────────────────────────────────────────┘
```

---

## コンポーネント

### プロジェクトカード

```
┌────────────────────────────────────────────────────────────────┐
│ 📁 [プロジェクト名]                               [ステータス] │
│    タスク: [総数] | 完了: [数] | 進行中: [数] | ブロック: [数] │
│    エージェント: [数] (🤖 [AI数] 👤 [人間数])                  │
│    更新: [相対時間] - [最新イベント]                           │
└────────────────────────────────────────────────────────────────┘
```

**最新イベント表示:**
| イベント種別 | 表示例 |
|-------------|--------|
| task_created | 「タスク作成」 |
| task_updated | 「タスク更新」 |
| status_changed | 「ステータス変更」 |
| handoff_created | 「ハンドオフ作成」 |
| agent_activity | 「エージェント活動」 |
| context_added | 「コンテキスト追加」 |

**ステータスバッジ:**
| ステータス | 表示 | 条件 |
|-----------|------|------|
| Active | ⚡ Active (青) | 進行中タスクあり |
| Blocked | 🔴 Blocked (赤) | ブロック中タスクあり、進行中なし |
| Idle | 💤 Idle (グレー) | 作業なし |
| Done | ✅ Done (緑) | 全タスク完了 |

---

## インタラクション

### プロジェクト選択
- **クリック**: プロジェクトを選択、タスクボードへ遷移
- **ダブルクリック**: 同上
- **右クリック**: コンテキストメニュー表示

### コンテキストメニュー

```
┌─────────────────────┐
│ 📋 タスクボードを開く │
├─────────────────────┤
│ ✏️ プロジェクト編集   │
│ 📊 統計を見る        │
├─────────────────────┤
│ 📦 アーカイブ        │
│ 🗑️ 削除              │
└─────────────────────┘
```

### 新規プロジェクト作成

```
┌────────────────────────────────────────────────────┐
│  新規プロジェクト                           [×]   │
├────────────────────────────────────────────────────┤
│                                                    │
│  プロジェクト名 *                                  │
│  ┌──────────────────────────────────────────────┐ │
│  │                                              │ │
│  └──────────────────────────────────────────────┘ │
│                                                    │
│  説明                                              │
│  ┌──────────────────────────────────────────────┐ │
│  │                                              │ │
│  │                                              │ │
│  └──────────────────────────────────────────────┘ │
│                                                    │
│  ☑ 自分をオーナーとして追加                       │
│                                                    │
│                     [キャンセル]  [作成]          │
│                                                    │
└────────────────────────────────────────────────────┘
```

---

## データ表示

### プロジェクト一覧のソート

| オプション | 説明 |
|-----------|------|
| 最近更新順 (デフォルト) | 更新日時の降順 |
| 名前順 | アルファベット順 |
| 作成日順 | 作成日時の降順 |
| タスク数順 | タスク数の降順 |

### フィルター

| フィルター | 説明 |
|-----------|------|
| すべて | 全プロジェクト |
| アクティブ | 進行中タスクあり |
| アーカイブ済み | アーカイブされたプロジェクト |

---

## 空状態

```
┌────────────────────────────────────────────────────┐
│                                                    │
│                      📁                            │
│                                                    │
│           プロジェクトがありません                 │
│                                                    │
│     最初のプロジェクトを作成して                   │
│     AIエージェントとの協働を始めましょう           │
│                                                    │
│              [+ 新規プロジェクト作成]              │
│                                                    │
└────────────────────────────────────────────────────┘
```

---

## 状態管理

```swift
struct ProjectListState {
    var projects: [Project]
    var projectSummaries: [ProjectID: ProjectSummary]  // プロジェクトごとのサマリ
    var selectedProjectId: ProjectID?
    var sortOption: SortOption
    var filterOption: FilterOption
    var isLoading: Bool
    var error: Error?
}

/// プロジェクトのサマリ情報（STATE_HISTORY.md連携）
struct ProjectSummary {
    var taskCount: Int
    var completedCount: Int
    var inProgressCount: Int
    var blockedCount: Int
    var agentCount: Int
    var aiAgentCount: Int
    var humanAgentCount: Int
    var lastEvent: LastEventInfo?      // 最新のイベント情報
}

/// 最新イベント情報
struct LastEventInfo {
    var eventType: EventType           // STATE_HISTORY.mdと共通
    var timestamp: Date
    var displayText: String            // 「タスク更新」「ハンドオフ作成」等
}

enum SortOption {
    case recentlyUpdated               // lastEvent.timestamp でソート
    case name
    case createdDate
    case taskCount
}

enum FilterOption {
    case all
    case active
    case archived
}
```

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2024-12-30 | 1.0.0 | 初版作成 |
| 2024-12-30 | 1.1.0 | STATE_HISTORY.md連携：最新イベント表示、ProjectSummary追加 |
