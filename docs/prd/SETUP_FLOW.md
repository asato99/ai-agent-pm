# セットアップフロー

アプリ初回起動からAIエージェント連携までのフロー設計。

---

## Phase 1: アプリ初回起動

```
┌─────────────────────────────────────────────────────────────┐
│  1. アプリ起動                                              │
│     ↓                                                       │
│  2. データディレクトリ作成                                   │
│     ~/Library/Application Support/AI Agent PM/              │
│     ↓                                                       │
│  3. 初期プロジェクト作成ウィザード                          │
│     - プロジェクト名                                        │
│     - 説明                                                  │
│     ↓                                                       │
│  4. 人間エージェント（自分）の登録                          │
│     - 名前: "owner"                                         │
│     - 役割: "プロジェクトオーナー"                          │
│     - タイプ: human                                         │
└─────────────────────────────────────────────────────────────┘
```

---

## Phase 2: AIエージェント作成

```
┌─────────────────────────────────────────────────────────────┐
│  1. 「新規エージェント」ボタン                              │
│     ↓                                                       │
│  2. エージェント情報入力                                    │
│     ┌─────────────────────────────────────┐                │
│     │ 名前: frontend-dev                  │                │
│     │ 役割: フロントエンド開発担当         │                │
│     │ 専門: React, TypeScript, CSS        │                │
│     │ タイプ: AI                          │                │
│     │ システムプロンプト: (任意)           │                │
│     └─────────────────────────────────────┘                │
│     ↓                                                       │
│  3. Agent ID発行: "agt_abc123"                              │
│     ↓                                                       │
│  4. Claude Code設定を表示                                   │
│     ┌─────────────────────────────────────┐                │
│     │ {                                   │ [コピー]       │
│     │   "mcpServers": {                   │                │
│     │     "agent-pm-frontend": {...}      │ [自動設定]     │
│     │   }                                 │                │
│     │ }                                   │                │
│     └─────────────────────────────────────┘                │
│     ↓                                                       │
│  5. 「自動設定」で ~/.claude/ に書き込み                    │
│     または「コピー」して手動設定                            │
│     ↓                                                       │
│  6. 「Claude Codeを再起動してください」                     │
└─────────────────────────────────────────────────────────────┘
```

---

## ユーザー体験（完全フロー）

| ステップ | アクション |
|----------|------------|
| 1 | App Storeまたは.dmgからインストール |
| 2 | アプリ起動、プロジェクト作成 |
| 3 | 自分（人間）をエージェントとして登録 |
| 4 | AIエージェントを作成（frontend-dev等） |
| 5 | 「自動設定」でClaude Code設定を更新 |
| 6 | Claude Codeを再起動 |
| 7 | Claude Codeで `get_my_profile` → 自分の役割を確認 |
| 8 | `get_my_tasks` → 担当タスクを確認 |
| 9 | 作業開始 |

---

## エージェント作成フロー詳細

```
┌─────────────────────────────────────────────────────────────┐
│  1. 人間がアプリでエージェントを作成                        │
│     ┌─────────────────────────────────────┐                │
│     │ 名前: frontend-dev                  │                │
│     │ 役割: フロントエンド開発担当         │                │
│     │ 専門: React, TypeScript, CSS        │                │
│     │ タイプ: AI                          │                │
│     └─────────────────────────────────────┘                │
│     → Agent ID発行: "agt_abc123"                           │
│                                                             │
│  2. Claude Code設定を生成（アプリが自動生成）               │
│     {                                                       │
│       "mcpServers": {                                       │
│         "agent-pm-frontend": {                              │
│           "command": "mcp-server-pm",                       │
│           "args": ["--agent-id", "agt_abc123"]              │
│         }                                                   │
│       }                                                     │
│     }                                                       │
│                                                             │
│  3. 設定をコピーしてClaude Code設定に追加                   │
│     または「自動設定」ボタンで直接書き込み                  │
│                                                             │
│  4. Claude Code起動 → エージェントとして認証される          │
└─────────────────────────────────────────────────────────────┘
```

---

## 人間エージェントの扱い

人間もエージェントとして管理される：

```
例:
┌─────────────────────────────────────────┐
│ Agents                                  │
├─────────────────────────────────────────┤
│ 👤 project-owner (human)                │
│    役割: プロジェクトオーナー           │
│                                         │
│ 🤖 frontend-dev (ai)                    │
│    役割: フロントエンド開発             │
│    専門: React, TypeScript              │
│                                         │
│ 🤖 backend-dev (ai)                     │
│    役割: バックエンド開発               │
│    専門: Go, PostgreSQL                 │
│                                         │
│ 🤖 reviewer (ai)                        │
│    役割: コードレビュー                 │
│    専門: セキュリティ, パフォーマンス   │
└─────────────────────────────────────────┘
```

**人間をエージェントとして扱う利点:**
- タスクのassigneeを統一的に扱える
- 人間↔AI間のハンドオフも同じ仕組みで管理
- 将来的にはAIが人間にタスクを依頼することも可能

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2024-12-30 | 1.0.0 | PRD.mdから分離して初版作成 |
