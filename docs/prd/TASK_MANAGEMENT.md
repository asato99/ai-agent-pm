# ã‚¿ã‚¹ã‚¯ç®¡ç†è¨­è¨ˆ

ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯ç®¡ç†ã®æ§‹æˆã¨ä¾å­˜é–¢ä¿‚ã®è¨­è¨ˆã€‚

---

## ã‚¿ã‚¹ã‚¯ãƒ¢ãƒ‡ãƒ«

### Task ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£

```
Task {
    id: TaskID
    projectId: ProjectID
    title: String
    description: String
    status: TaskStatus
    priority: Priority
    assigneeId: AgentID?
    dependencies: [TaskID]          // Finish-to-Start ä¾å­˜
    createdBy: AgentID
    createdAt: Date
    updatedAt: Date
}

TaskStatus {
    backlog                         // ãƒãƒƒã‚¯ãƒ­ã‚°ï¼ˆæœªç€æ‰‹ï¼‰
    todo                            // ç€æ‰‹äºˆå®š
    inProgress                      // ä½œæ¥­ä¸­
    review                          // ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­
    done                            // å®Œäº†
    blocked                         // ãƒ–ãƒ­ãƒƒã‚¯ä¸­
}

Priority {
    low
    medium
    high
    urgent
}
```

### è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£

```
Task (computed) {
    blockedBy: [TaskID]             // æœªå®Œäº†ã®ä¾å­˜ã‚¿ã‚¹ã‚¯
    isReady: Bool                   // blockedBy.isEmpty && status != .done
    dependents: [TaskID]            // ã“ã®ã‚¿ã‚¹ã‚¯ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯
}
```

---

## ä¾å­˜é–¢ä¿‚

### æ–¹å¼: Finish-to-Start ã®ã¿ï¼ˆMVPï¼‰

```
[Task A] â”€â”€â”€â”€å®Œäº†å¾Œâ”€â”€â”€â”€â†’ [Task B]

Task B ã¯ Task A ãŒ done ã«ãªã‚‹ã¾ã§é–‹å§‹ã§ããªã„
```

### ä¾å­˜é–¢ä¿‚ã®ãƒ«ãƒ¼ãƒ«

| ãƒ«ãƒ¼ãƒ« | èª¬æ˜ |
|--------|------|
| **å˜æ–¹å‘** | A â†’ B ã¯ã€ŒBã¯Aã«ä¾å­˜ã€ã‚’æ„å‘³ |
| **å¾ªç’°ç¦æ­¢** | A â†’ B â†’ C â†’ A ã¯ä¸å¯ |
| **è‡ªå·±å‚ç…§ç¦æ­¢** | A â†’ A ã¯ä¸å¯ |
| **å®Œäº†ãƒã‚§ãƒƒã‚¯** | ä¾å­˜å…ˆãŒ done ã§ãªã„ã¨ isReady = false |

### ä¾å­˜é–¢ä¿‚ã®çŠ¶æ…‹é·ç§»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Task B (depends on Task A)                                 â”‚
â”‚                                                             â”‚
â”‚  Task A: todo      â†’ Task B: blocked (blockedBy: [A])      â”‚
â”‚  Task A: inProgress â†’ Task B: blocked (blockedBy: [A])      â”‚
â”‚  Task A: done       â†’ Task B: ready   (blockedBy: [])       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¤‡æ•°ä¾å­˜

```
Task C depends on [Task A, Task B]

Task A: done, Task B: inProgress
  â†’ Task C: blocked (blockedBy: [B])

Task A: done, Task B: done
  â†’ Task C: ready
```

---

## ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ãƒ­ãƒ¼

### åŸºæœ¬ãƒ•ãƒ­ãƒ¼

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  blocked â”‚ â†â”€â”€ ä¾å­˜æœªè§£æ±º
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                         â”‚ ä¾å­˜è§£æ±º
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ backlog â”‚ â†’  â”‚   todo   â”‚ â†’  â”‚ inProgress â”‚ â†’  â”‚ review â”‚ â†’  â”‚ done â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜
     â†‘              â†‘                                              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å·®ã—æˆ»ã— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã®æ¨©é™

| é·ç§» | Owner | Manager | Worker (è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯) |
|------|:-----:|:-------:|:--------------------:|
| backlog â†’ todo | âœ… | âœ… | âŒ |
| todo â†’ inProgress | âœ… | âœ… | âœ… |
| inProgress â†’ review | âœ… | âœ… | âœ… |
| review â†’ done | âœ… | âœ… | âŒ (ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰¿èªãŒå¿…è¦) |
| any â†’ blocked | âœ… | âœ… | âœ… |
| blocked â†’ todo | âœ… | âœ… | âœ… (ä¾å­˜è§£æ±ºå¾Œ) |
| any â†’ backlog (å·®ã—æˆ»ã—) | âœ… | âœ… | âŒ |

---

## ã‚¿ã‚¹ã‚¯ã®éšå±¤

### MVP: ãƒ•ãƒ©ãƒƒãƒˆ + ã‚µãƒ–ã‚¿ã‚¹ã‚¯

```
Project
â””â”€â”€ Task (è¦ªã‚¿ã‚¹ã‚¯)
    â””â”€â”€ Subtask (å­ã‚¿ã‚¹ã‚¯ã€ä»»æ„)
```

### Subtask ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£

```
Subtask {
    id: SubtaskID
    parentTaskId: TaskID
    title: String
    isCompleted: Bool
    createdBy: AgentID
    createdAt: Date
}
```

### ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã®ç”¨é€”

```
Task: ã€Œèªè¨¼æ©Ÿèƒ½å®Ÿè£…ã€ (Manager ãŒä½œæˆ)
â”œâ”€â”€ Subtask: ã€ŒJWTãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆã€ (Worker ãŒè‡ªåˆ†ã§åˆ†è§£)
â”œâ”€â”€ Subtask: ã€Œãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å‡¦ç†ã€
â”œâ”€â”€ Subtask: ã€Œãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†ã€
â””â”€â”€ Subtask: ã€Œå˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆã€

â†’ ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã¯ Worker ãŒè‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯å†…ã§è‡ªç”±ã«ä½œæˆå¯èƒ½
â†’ é€²æ—ã®ç´°åˆ†åŒ–ã€ä½œæ¥­ã®æ•´ç†ã«ä½¿ç”¨
```

---

## ã‚¢ã‚µã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆ

### ã‚¢ã‚µã‚¤ãƒ³ã®ãƒ«ãƒ¼ãƒ«

| æ“ä½œ | æ¨©é™ | æ¡ä»¶ |
|------|------|------|
| ä»–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚¢ã‚µã‚¤ãƒ³ | Managerä»¥ä¸Š | - |
| è‡ªåˆ†ã«ã‚¢ã‚µã‚¤ãƒ³ | Workerä»¥ä¸Š | ã‚¿ã‚¹ã‚¯ãŒæœªã‚¢ã‚µã‚¤ãƒ³ |
| ã‚¢ã‚µã‚¤ãƒ³è§£é™¤ | Managerä»¥ä¸Š | - |
| è‡ªåˆ†ã®ã‚¢ã‚µã‚¤ãƒ³è§£é™¤ | Workerä»¥ä¸Š | è‡ªåˆ†ãŒã‚¢ã‚µã‚¤ãƒ³ã•ã‚Œã¦ã„ã‚‹ |

### ã‚¢ã‚µã‚¤ãƒ³æ™‚ã®é€šçŸ¥

```
Manager ãŒ Task A ã‚’ frontend-dev ã«ã‚¢ã‚µã‚¤ãƒ³
    â†“
Task A ã® assigneeId ãŒæ›´æ–°ã•ã‚Œã‚‹
    â†“
frontend-dev ã®æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§:
  get_my_tasks() â†’ Task A ãŒå«ã¾ã‚Œã‚‹
  get_pending_handoffs() â†’ ã‚¢ã‚µã‚¤ãƒ³é€šçŸ¥ãŒå«ã¾ã‚Œã‚‹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

---

## ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¿ã‚¹ã‚¯å–å¾—ãƒ•ãƒ­ãƒ¼

### ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚

```swift
// 1. è‡ªåˆ†ã®ã‚¿ã‚¹ã‚¯ã‚’å–å¾—
let myTasks = get_my_tasks()

// 2. ç€æ‰‹å¯èƒ½ãªã‚¿ã‚¹ã‚¯ã‚’ãƒ•ã‚£ãƒ«ã‚¿
let readyTasks = myTasks.filter { $0.isReady }
let blockedTasks = myTasks.filter { !$0.isReady }

// 3. ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã‚¿ã‚¹ã‚¯ã®ä¾å­˜ã‚’ç¢ºèª
for task in blockedTasks {
    let blockers = task.blockedBy.map { get_task($0) }
    // blockers ã®æ‹…å½“è€…ã¨é€²æ—ã‚’ç¢ºèª
}

// 4. ç€æ‰‹å¯èƒ½ãªã‚¿ã‚¹ã‚¯ã‹ã‚‰å„ªå…ˆåº¦é †ã«é¸æŠ
let nextTask = readyTasks.sorted { $0.priority > $1.priority }.first
```

### MCP Tools

| Tool | èª¬æ˜ |
|------|------|
| `get_my_tasks` | è‡ªåˆ†ã«ã‚¢ã‚µã‚¤ãƒ³ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ä¸€è¦§ |
| `get_ready_tasks` | é–‹å§‹å¯èƒ½ãªã‚¿ã‚¹ã‚¯ï¼ˆä¾å­˜è§£æ±ºæ¸ˆã¿ã€æœªã‚¢ã‚µã‚¤ãƒ³å«ã‚€ï¼‰ |
| `get_blocked_tasks` | ãƒ–ãƒ­ãƒƒã‚¯ä¸­ã®ã‚¿ã‚¹ã‚¯ä¸€è¦§ |
| `get_task_dependencies` | ç‰¹å®šã‚¿ã‚¹ã‚¯ã®ä¾å­˜é–¢ä¿‚ |
| `get_task_dependents` | ç‰¹å®šã‚¿ã‚¹ã‚¯ã«ä¾å­˜ã—ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ |

---

## ä¾å­˜é–¢ä¿‚ã®æ“ä½œ

### ä¾å­˜ã®è¿½åŠ 

```
add_dependency(taskId: "task-B", dependsOn: "task-A")

çµæœ:
- Task B ã® dependencies ã« Task A ãŒè¿½åŠ 
- Task A ãŒæœªå®Œäº†ãªã‚‰ Task B ã¯ blocked ã«ãªã‚‹
```

### ä¾å­˜ã®å‰Šé™¤

```
remove_dependency(taskId: "task-B", dependsOn: "task-A")

çµæœ:
- Task B ã® dependencies ã‹ã‚‰ Task A ã‚’å‰Šé™¤
- ä»–ã®æœªå®Œäº†ä¾å­˜ãŒãªã‘ã‚Œã° Task B ã¯ ready ã«ãªã‚‹
```

### å¾ªç’°ãƒã‚§ãƒƒã‚¯

```swift
func addDependency(taskId: TaskID, dependsOn: TaskID) throws {
    // 1. è‡ªå·±å‚ç…§ãƒã‚§ãƒƒã‚¯
    guard taskId != dependsOn else {
        throw DependencyError.selfReference
    }

    // 2. å¾ªç’°ãƒã‚§ãƒƒã‚¯ï¼ˆDFSï¼‰
    if wouldCreateCycle(from: dependsOn, to: taskId) {
        throw DependencyError.circularDependency
    }

    // 3. ä¾å­˜è¿½åŠ 
    task.dependencies.append(dependsOn)
}
```

---

## å¯è¦–åŒ–

### ã‚¿ã‚¹ã‚¯ãƒœãƒ¼ãƒ‰ãƒ“ãƒ¥ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Project: ECã‚µã‚¤ãƒˆé–‹ç™º                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Backlog  â”‚   Todo   â”‚ Progress â”‚  Review  â”‚   Done   â”‚  Blocked    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚ ğŸ”µ DBè¨­è¨ˆ â”‚ ğŸŸ¢ APIè¨­è¨ˆâ”‚          â”‚ âœ… è¦ä»¶  â”‚ ğŸ”´ APIçµ±åˆ  â”‚
â”‚          â”‚  æœªã‚¢ã‚µã‚¤ãƒ³â”‚  backend â”‚          â”‚   å®šç¾©   â”‚   å¾…ã¡:     â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚   APIè¨­è¨ˆ   â”‚
â”‚          â”‚          â”‚          â”‚          â”‚          â”‚   DBè¨­è¨ˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾å­˜ã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ï¼ˆå°†æ¥ï¼‰

```
[è¦ä»¶å®šç¾©] âœ…
    â”œâ”€â”€â†’ [APIè¨­è¨ˆ] ğŸŸ¢ backend-dev
    â”‚        â””â”€â”€â†’ [APIçµ±åˆ] ğŸ”´ blocked
    â”‚
    â””â”€â”€â†’ [DBè¨­è¨ˆ] ğŸ”µ æœªã‚¢ã‚µã‚¤ãƒ³
             â””â”€â”€â†’ [APIçµ±åˆ] ğŸ”´ blocked
```

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|----------|
| 2024-12-30 | 1.0.0 | åˆç‰ˆä½œæˆ |
